<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cook Tracker</title>
    <style>
        /* General Styles */
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .main-container {
            background-color: white;
            width: 100%;
            max-width: 400px;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
        }

        h1 {
            text-align: center;
            font-size: 22px;
            color: #333;
            margin-bottom: 25px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        /* --- SELECTOR BOXES --- */
        .selector-box {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 15px 20px;
            font-size: 16px;
            color: #333;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between; 
            align-items: center;
            margin-bottom: 20px;
            position: relative; 
        }

        .arrow-icon { color: #999; font-size: 12px; pointer-events: none; }
        
        .hidden-input {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            opacity: 0; cursor: pointer;
        }

        /* --- COOK STATUS CARD (TOGGLE STYLE) --- */
        .status-card {
            /* DEFAULT STATE (Not Present) */
            background-color: #fafafa; 
            border: 2px dashed #e0e0e0; /* Dashed border means "Click me" */
            border-radius: 16px;
            padding: 15px; 
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .status-card .check-icon {
            background-color: #e0e0e0;
            color: white;
            width: 40px; height: 40px;
            border-radius: 8px;
            display: inline-flex; align-items: center; justify-content: center;
            font-size: 24px; margin-bottom: 8px;
            transition: all 0.2s;
        }

        .status-card .status-text {
            color: #9e9e9e;
            font-weight: 600;
            font-size: 16px;
            display: block;
        }

        /* ACTIVE STATE (When Class 'active' is added) */
        .status-card.active {
            background-color: #e8f5e9; /* Light Green */
            border: 2px solid #4caf50; /* Solid Green Border */
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.2);
        }

        .status-card.active .check-icon {
            background-color: #4caf50;
        }

        .status-card.active .status-text {
            color: #2e7d32;
            font-weight: 700;
        }

        /* --- SUMMARY SECTION --- */
        .section-title {
            font-size: 12px; letter-spacing: 1px; font-weight: bold;
            color: #9e9e9e; margin-bottom: 10px; text-transform: uppercase;
        }

        .summary-grid {
            display: flex; gap: 15px; margin-bottom: 30px;
        }

        .summary-box {
            flex: 1; border-radius: 16px; padding: 15px; color: white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            display: flex; flex-direction: column; justify-content: center;
        }

        .box-visits { background: linear-gradient(135deg, #FF9800, #FF5722); }
        .box-bill { background: linear-gradient(135deg, #2979ff, #2196F3); }

        .box-label { font-size: 12px; opacity: 0.9; margin-bottom: 5px; }
        .box-value { font-size: 24px; font-weight: 700; }
        .unit { font-size: 14px; font-weight: 400; opacity: 0.8; }

        /* --- HISTORY LIST --- */
        .history-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 0; border-bottom: 1px solid #f0f0f0;
        }
        .history-date { font-size: 16px; color: #555; }
        .delete-icon { font-size: 18px; opacity: 0.4; cursor: pointer; padding: 5px; }
        .delete-icon:hover { opacity: 1; color: red; }

    </style>
</head>
<body>

    <div class="main-container">
        
        <h1>üë©‚Äçüç≥ Cook Tracker</h1>

        <div class="selector-box">
            <span id="displayDate">Loading...</span>
            <span class="arrow-icon">‚ñº</span>
            <input type="date" class="hidden-input" id="datePicker" onchange="handleDateChange()">
        </div>

        <div class="status-card" id="statusCard" onclick="toggleAttendance()">
            <div class="check-icon">‚úì</div>
            <span class="status-text" id="statusText">Mark Present</span>
        </div>

        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">

        <div class="section-title">Monthly Report</div>

        <div class="selector-box">
            <span id="displayMonth">Loading...</span>
            <span class="arrow-icon">‚ñº</span>
            <select class="hidden-input" id="monthPicker" onchange="handleMonthChange()">
                </select>
        </div>

        <div class="summary-grid">
            <div class="summary-box box-visits">
                <span class="box-label">Total Visits</span>
                <span class="box-value"><span id="totalVisits">0</span> <span class="unit">days</span></span>
            </div>

            <div class="summary-box box-bill">
                <span class="box-label">Total Bill</span>
                <span class="box-value">‚Çπ <span id="totalBill">0</span></span>
            </div>
        </div>

        <div class="section-title">History</div>
        <div class="history-list" id="historyList">
            </div>

    </div>

    <script>
        // --- 1. INITIALIZATION ---
        // Load data from storage OR start with empty list
        let attendanceData = JSON.parse(localStorage.getItem('cookData')) || [];
        
        const datePicker = document.getElementById('datePicker');
        const monthPicker = document.getElementById('monthPicker');
        const statusCard = document.getElementById('statusCard');
        const statusText = document.getElementById('statusText');

        // Set Today's Date
        const today = new Date().toISOString().split('T')[0];
        datePicker.value = today;

        // Populate Month Dropdown (Last 12 Months)
        populateMonthDropdown();

        // Initial Render
        updateDashboard();

        // --- 2. CORE LOGIC ---

        function toggleAttendance() {
            const selectedDate = datePicker.value;
            
            // Check if date exists in array
            const index = attendanceData.indexOf(selectedDate);

            if (index > -1) {
                // If exists, REMOVE it (Toggle Off)
                attendanceData.splice(index, 1);
            } else {
                // If not exists, ADD it (Toggle On)
                attendanceData.push(selectedDate);
            }

            // Save and Update
            saveData();
            updateDashboard();
        }

        function deleteEntry(dateToDelete) {
            if(confirm("Delete entry for " + dateToDelete + "?")) {
                attendanceData = attendanceData.filter(d => d !== dateToDelete);
                saveData();
                updateDashboard();
            }
        }

        function saveData() {
            localStorage.setItem('cookData', JSON.stringify(attendanceData));
        }

        // --- 3. UI UPDATES ---

        function handleDateChange() {
            updateDashboard();
        }

        function handleMonthChange() {
            updateDashboard();
        }

        function updateDashboard() {
            const selectedDate = datePicker.value;
            const selectedMonthVal = monthPicker.value; // e.g., "2025-11"

            // A. UPDATE HEADER TEXTS
            document.getElementById('displayDate').innerText = formatDateReadable(selectedDate);
            
            const monthText = monthPicker.options[monthPicker.selectedIndex].text;
            document.getElementById('displayMonth').innerText = monthText;

            // B. UPDATE GREEN BOX STATE
            if (attendanceData.includes(selectedDate)) {
                statusCard.classList.add('active');
                statusText.innerText = "Cook Came Today";
            } else {
                statusCard.classList.remove('active');
                statusText.innerText = "Mark Present";
            }

            // C. FILTER DATA FOR SELECTED MONTH
            // Filter dates that start with the selected YYYY-MM
            const monthVisits = attendanceData.filter(date => date.startsWith(selectedMonthVal));
            
            // Sort them (newest first)
            monthVisits.sort((a, b) => b.localeCompare(a));

            // D. UPDATE COUNTS
            const count = monthVisits.length;
            const bill = count * 100;

            document.getElementById('totalVisits').innerText = count;
            document.getElementById('totalBill').innerText = bill;

            // E. UPDATE HISTORY LIST
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = ""; // Clear list

            monthVisits.forEach(date => {
                const readableDate = formatDateReadable(date);
                const itemHTML = `
                    <div class="history-item">
                        <span class="history-date">${readableDate}</span>
                        <span class="delete-icon" onclick="deleteEntry('${date}')">üóëÔ∏è</span>
                    </div>
                `;
                historyList.innerHTML += itemHTML;
            });
        }

        // --- 4. HELPERS ---

        function populateMonthDropdown() {
            const current = new Date();
            // Generate last 6 months options
            for (let i = 0; i < 6; i++) {
                const d = new Date(current.getFullYear(), current.getMonth() - i, 1);
                // Value format: "2025-11" (Easy to filter)
                const value = d.toISOString().slice(0, 7); 
                // Text format: "November 2025"
                const text = d.toLocaleString('default', { month: 'long', year: 'numeric' });
                
                const option = document.createElement('option');
                option.value = value;
                option.text = text;
                monthPicker.appendChild(option);
            }
            // Select current month by default
            monthPicker.selectedIndex = 0;
        }

        function formatDateReadable(dateString) {
            const d = new Date(dateString);
            return d.toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' });
        }

    </script>

</body>
</html>
